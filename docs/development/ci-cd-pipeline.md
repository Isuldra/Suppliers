# CI/CD Pipeline for SupplyChain OneMed

This document describes the continuous integration (CI) process for the SupplyChain OneMed application, using GitHub Actions as the automation platform. It covers building the application and preparing artifacts for manual release.

## Overview

The CI pipeline ensures that every change to the codebase is automatically built. The pipeline is designed to:

- Run on every push and pull request to the `main` branch
- Build the Electron and React application for Windows (installer and portable) and macOS (x64, arm64)
- Upload build artifacts (installers, portable version, dmg) to GitHub Actions for download

**Note:** This pipeline builds the application artifacts but does **not** automatically publish releases to GitHub. Publishing is a manual process using the artifacts generated by this CI workflow.
**Note:** Currently, linting, typechecking, and automated testing steps are **missing** from the pipeline and should be added for improved code quality and reliability.

## Requirements

- **GitHub repository** with Actions enabled
- **Node.js 20.x** (configured in the workflow)
- All build scripts defined in `package.json`
- All dependencies installable via `npm ci` or `npm install`

## Pipeline Steps (Actual Workflow)

1. **Checkout** the repository
2. **Set up Node.js** (version 20.x)
3. **Cache/Install dependencies** using `npm ci` or `npm install`
4. **(Windows)** Preinstall optional native dependencies
5. **Build the renderer** with `npm run build`
6. **Build Electron artifacts** using `electron-builder` directly (e.g., `npx electron-builder --win --publish never` or `npx electron-builder --mac --[arch] --publish never`)
7. **Upload build artifacts** (contents of `release/` directory) to GitHub Actions

## Example GitHub Actions Workflow Structure

_(Based on `.github/workflows/build.yml` - simplified representation)_

```yaml
name: üèóÔ∏è Build Electron App for macOS & Windows

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  build-macos:
    name: Build for macOS (${{ matrix.arch }})
    runs-on: macos-latest
    strategy:
      matrix:
        arch: [x64, arm64]
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20.x'
          cache: "npm"

      - name: Install dependencies
        run: npm ci --ignore-scripts

      - name: Build Application (macOS ${{ matrix.arch }})
        run: |
          npm run build
          npx electron-builder --mac --${{ matrix.arch }} --publish never

      - name: Upload macOS Artifact
        uses: actions/upload-artifact@v4
        with:
          name: Supplier-Reminder-Pro-macOS-${{ matrix.arch }}
          path: release/

  build-windows:
    name: Build for Windows (x64)
    runs-on: windows-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20.x'

      - name: Preinstall Windows native modules
        run: |
          npm install --save-optional @rollup/rollup-win32-x64-msvc
          npm install --save-optional @esbuild/win32-x64

      - name: Install dependencies
        run: npm install

      - name: Build Application (Windows x64)
        run: |
          npm run build
          npx electron-builder --win --publish never

      - name: Upload Windows Artifact
        uses: actions/upload-artifact@v4
        with:
          name: Supplier-Reminder-Pro-Windows-x64
          path: release/

## Notes

- The actual workflow separates builds for macOS (x64, arm64) and Windows (x64) into distinct jobs
- The workflow uses current versions of GitHub Actions (e.g., `@v4`)
- Linting, typechecking, and automated tests are **not currently part of the CI pipeline** and should be added
- Build artifacts (the contents of the `release` directory for each job) are uploaded to the GitHub Actions run summary page for manual download
- **Manual Publishing**: After a successful CI run (e.g., on a tagged commit), download the necessary artifacts from the Actions run and follow the manual publishing steps outlined in [Publishing Updates Guide](publishing-updates.md)

## References

- [electron-builder documentation](https://www.electron.build/)
- [GitHub Actions documentation](https://docs.github.com/en/actions)
- [Publishing Updates Guide](publishing-updates.md)
```
