# Data Export

This document provides detailed information about the data export functionality in Supplier Reminder Pro.

## Overview

The data export feature allows users to extract application data into various formats for external use, reporting, backup, and integration with other systems. This functionality ensures data portability and enables extended analysis beyond the application's built-in reporting capabilities.

## Supported Export Formats

The application supports exporting data to the following formats:

### Excel (.xlsx)

- **Structure**: Multi-sheet workbook with formatted data
- **Formatting**: Cell formatting, header styling, and data type preservation
- **Compatibility**: Compatible with Microsoft Excel 2007 and newer, LibreOffice, and other spreadsheet applications
- **Size Limit**: Suitable for exports up to hundreds of thousands of records

### CSV (Comma Separated Values)

- **Structure**: Simple text format with comma-delimited values
- **Encoding**: UTF-8 encoding with BOM (Byte Order Mark) for international character support
- **Compatibility**: Universal compatibility with virtually all data processing applications
- **Size Limit**: Efficient for very large data sets

### PDF (Portable Document Format)

- **Structure**: Formatted document with tables, headers, and pagination
- **Formatting**: Professional layout with company branding and metadata
- **Compatibility**: Viewable on any device with a PDF reader
- **Use Case**: Best for formal reports and printed documentation

### JSON (JavaScript Object Notation)

- **Structure**: Hierarchical data representation in JSON format
- **Formatting**: Structured format with nested objects and arrays
- **Compatibility**: Ideal for integration with web services and applications
- **Use Case**: Best for programmatic data interchange

## Exportable Data Types

The following data types can be exported:

### Supplier Data

- Complete supplier directory with contact information
- Supplier performance metrics and statistics
- Filtered subsets of suppliers based on criteria

### Order Data

- Complete order history with status information
- Current outstanding orders
- Orders filtered by date range, status, or supplier

### Communication History

- Email communication logs
- Reminder history by supplier
- Response rates and effectiveness metrics

### Report Data

- Any report generated by the reporting module
- Custom reports with user-selected fields
- Aggregated statistics and summaries

## Export Process

### Export Configuration

Users can configure exports through the Export dialog with options for:

1. **Data Selection**: Choose which data to export
2. **Format Selection**: Select the desired output format
3. **Filter Application**: Apply filters to limit the exported data
4. **Field Selection**: Choose which fields to include in the export
5. **Output Configuration**: Set file name, location, and format-specific options

### Export Workflow

The typical export workflow follows these steps:

1. User navigates to the section containing data to export
2. User selects the "Export" option from the actions menu
3. Export configuration dialog appears for customization
4. User configures export parameters and confirms
5. Application processes and generates the export file
6. File is saved to the specified location or opened directly

## Implementation Details

### Excel Export

```typescript
// Example of Excel export implementation
import * as XLSX from "xlsx";

const exportToExcel = (data, filename = "export.xlsx") => {
  try {
    // Create a new workbook
    const wb = XLSX.utils.book_new();

    // Convert data to worksheet format
    const ws = XLSX.utils.json_to_sheet(data);

    // Add worksheet to workbook
    XLSX.utils.book_append_sheet(wb, ws, "Data");

    // Generate Excel file buffer
    const excelBuffer = XLSX.write(wb, { bookType: "xlsx", type: "buffer" });

    // Trigger file download
    const blob = new Blob([excelBuffer], {
      type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
    });

    // Use Electron's dialog to save file
    return window.electron.saveFile(blob, filename);
  } catch (error) {
    console.error("Excel export error:", error);
    throw new Error(`Failed to export Excel file: ${error.message}`);
  }
};
```

### PDF Export

```typescript
// Example of PDF export implementation
import { jsPDF } from "jspdf";
import "jspdf-autotable";

const exportToPDF = (data, columns, filename = "export.pdf") => {
  try {
    // Create new PDF document
    const doc = new jsPDF();

    // Add company header
    doc.setFontSize(20);
    doc.text("OneMed SupplyChain", 14, 22);
    doc.setFontSize(12);
    doc.text(`Generated on ${new Date().toLocaleDateString()}`, 14, 30);

    // Add table with data
    doc.autoTable({
      head: [columns.map((col) => col.header)],
      body: data.map((row) => columns.map((col) => row[col.field])),
      startY: 40,
      theme: "grid",
      styles: { fontSize: 10, cellPadding: 3 },
      headerStyles: { fillColor: [73, 120, 134], textColor: 255 },
    });

    // Add page numbers
    const pageCount = doc.internal.getNumberOfPages();
    for (let i = 1; i <= pageCount; i++) {
      doc.setPage(i);
      doc.setFontSize(10);
      doc.text(
        `Page ${i} of ${pageCount}`,
        doc.internal.pageSize.width - 30,
        doc.internal.pageSize.height - 10
      );
    }

    // Use Electron's dialog to save file
    return window.electron.saveFile(doc.output("blob"), filename);
  } catch (error) {
    console.error("PDF export error:", error);
    throw new Error(`Failed to export PDF file: ${error.message}`);
  }
};
```

## Integration with Other Features

The data export functionality integrates with other application features:

- **Reporting Module**: Any report can be exported to supported formats
- **Database Service**: Data is retrieved through the database service API
- **Filtering System**: Uses the same filtering system as the main application
- **File System Access**: Securely saves files through Electron's dialog API

## Customization Options

Users can customize exports in several ways:

- **Column Selection**: Choose which columns to include
- **Sort Order**: Specify the sort order of exported data
- **Grouping**: Group data by specific fields
- **Formatting**: Apply custom formatting (especially for Excel exports)
- **Headers/Footers**: Include custom headers, footers, and page numbers
- **Branding**: Add company logo and branding elements

## Security Considerations

The export functionality implements the following security measures:

- **Data Privacy**: Only data the user has access to can be exported
- **Sanitization**: All data is sanitized before export to prevent injection attacks
- **File System Security**: Files are saved securely using Electron's dialog API
- **Limited Information**: Exports do not include sensitive system information

## Performance Considerations

For handling large data sets, the export functionality implements:

- **Chunked Processing**: Large exports are processed in chunks to avoid memory issues
- **Progress Indicators**: Progress is displayed for long-running exports
- **Optimization**: Format-specific optimizations for large data volumes
- **Background Processing**: Exports run in the background to maintain UI responsiveness

## Usage Examples

### Exporting Supplier Data

```jsx
// React component example for exporting supplier data
const ExportSuppliers = () => {
  const [suppliers, setSuppliers] = useState([]);
  const [loading, setLoading] = useState(false);

  useEffect(() => {
    // Load suppliers when component mounts
    loadSuppliers();
  }, []);

  const loadSuppliers = async () => {
    setLoading(true);
    try {
      const result = await window.electron.getAllSuppliers();
      if (result.success) {
        setSuppliers(result.data || []);
      }
    } catch (error) {
      console.error("Failed to load suppliers:", error);
      toast.error("Could not load supplier data");
    } finally {
      setLoading(false);
    }
  };

  const handleExport = async (format) => {
    try {
      if (suppliers.length === 0) {
        toast.warn("No supplier data to export");
        return;
      }

      const result = await window.electron.exportData({
        data: suppliers,
        format: format,
        filename: `suppliers-${format(new Date(), "yyyy-MM-dd")}`,
        type: "suppliers",
      });

      if (result.success) {
        toast.success(`Suppliers exported as ${format}`);
      } else {
        toast.error(`Export failed: ${result.error}`);
      }
    } catch (error) {
      console.error("Export error:", error);
      toast.error("Failed to export suppliers");
    }
  };

  return (
    <div>
      <h2>Export Suppliers</h2>
      <div className="export-buttons">
        <button onClick={() => handleExport("excel")} disabled={loading}>
          Export to Excel
        </button>
        <button onClick={() => handleExport("csv")} disabled={loading}>
          Export to CSV
        </button>
        <button onClick={() => handleExport("pdf")} disabled={loading}>
          Export to PDF
        </button>
      </div>
    </div>
  );
};
```

## Best Practices

1. **Select Appropriate Format**: Choose the export format based on intended use
2. **Include Metadata**: Add generation date, user, and filter criteria to exports
3. **Regular Export Schedule**: Establish a regular schedule for data exports as backups
4. **Validate Exports**: Periodically verify that exported data is complete and accurate
5. **Consider Privacy**: Be mindful of data privacy when exporting and sharing files

## Troubleshooting

Common issues and their solutions:

1. **Export Timeout**: For large data sets, try exporting in smaller batches
2. **Formatting Issues**: Verify compatibility with the target application
3. **Character Encoding**: Use UTF-8 encoding for international character support
4. **Missing Data**: Check filter settings to ensure all intended data is included
5. **File Access Errors**: Verify write permissions for the output location

## Related Features

- [Database Storage](database-storage.md) - Source of data for export
- [Reporting](reporting.md) - Generate reports that can be exported
- [Backup and Restore](backup-restore.md) - Using exports as a backup mechanism
